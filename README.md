# VPN
## Домашнее задание по теме _Мосты, туннели и VPN_   
> 1. Между двумя виртуалками поднять vpn в режимах  
>* tun;    
>* tap;  
Прочуствовать разницу.  
> 2. Поднять RAS на базе OpenVPN с клиентскими сертификатами, подключиться с локальной машины на виртуалку.  

### Решение ДЗ. 
Перед началом работы необходимо выполнить _vagrant plugin install vagrant-sshfs_. Эта команда установит плагин, используемый в данных примерах.  
1. Выполнение происходит автоматически, при помощи _Vagrant+Ansible_. Задание сделано согласно методичке, с небольшими изменениями.  
* VPN  в режиме tap.   
Для проверки подключаемся к машинам и выполняем:  
на сервере  _iperf3 -s &_, на клиенте _iperf3 -c 10.10.10.1 -t 30 -i 5_  
Результаты выполнения:  

сервер  

![](https://github.com/Vitaliy7/VPN/blob/main/TUN_TAP/screenshots/tap_s.png?raw=true)

клиент  

![](https://github.com/Vitaliy7/VPN/blob/main/TUN_TAP/screenshots/tap_c.png?raw=true)  

* VPN в режиме tun  
Хосты сконфигурированы на использование виртуального драйвера _tap_, поэтому для применения _tun_  
следует переписать конфигурационные файлы _server.conf_ и _client.conf_ в директиве _dev_ на режим _tun_ и перезапустить  
_openvpn@server_, затем выполнить на сервере  _iperf3 -s &_, на клиенте _iperf3 -c 10.10.10.1 -t 30 -i 5_  
Результат:  

сервер  

![](https://github.com/Vitaliy7/VPN/blob/main/TUN_TAP/screenshots/tun_s.png?raw=true)

клиент  

![](https://github.com/Vitaliy7/VPN/blob/main/TUN_TAP/screenshots/tun_c.png?raw=true)  

Как видно, _tun_ быстрее, но разница незначительна (во всяком случае, в этом примере). 
Эти режимы работают на разных моделях _OSI_, _tap_ эмулирует Ethernet устройство и работает на канальном уровне, а _tun_ работает в режиме сетевого туннеля  
на сетевом уровне. Поэтому при выборе этих режимов следует исходить из требований, предъявляемых к конкретной сети.  

2. Поднять RAS на базе OpenVPN  
Выполнение этой части задания также автоматическое. После развертывания машины, на хосте выполняем  
_sudo openvpn --config client.conf_  
Так мы подключились к серверу, проверяем доступность  
_ping -c 4 10.10.10.1_  
И импорт сети тоннеля в таблицу маршрутизаци на хосте  

![](https://github.com/Vitaliy7/VPN/blob/main/RAS/screenshots/netstat.png?raw=true)
